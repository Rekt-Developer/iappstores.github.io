<html lang="en">

<!-- Added by HTTrack -->
<meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->

<head>
  <!-- Meta Tags -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <base src="../index.html" />
  <!-- Title -->
  <title>TKStudio - Customer</title>
  <!-- Desc -->
  <meta name="description" content="TKStudio offers a hack which is undetected! Download our Cheat now!">
  <!-- Icon -->
  <link rel="icon" type="image/png" sizes="64x64" href="../app/images/favicon3860.png?v=1">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="../app/css/bootstrap.min.css">
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&amp;display=swap"
    rel="stylesheet">
  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
  <!-- Main CSS -->
  <link rel="stylesheet" type="text/css" href="../app/css/main.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
</head>

<body>
  <section id="customerSec">
    <div class="container">
      <div class="row">
        <div class="col-lg-6 offset-lg-3 col-md-8 offset-md-2 section-head text-center">
          <div class="section-head-tag"><a href="../index.html"><img src="../app/images/logo.png" alt="Fer3on"></a>
          </div>
          <h2 class="section-head-title">TKStudio Activator</h2>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-6 offset-lg-3 col-md-8 offset-md-2 section-head text-center">
          <div class="auth-form card">
            <div class="card-body">
              <div class="row">
                <div class="col-12">
                  <label class="form-label">Hardware ID</label>
                  <input class="form-control" type="text" id="hwid" name="key" autocomplete="off" />
                  <label class="form-label">Token</label>
                  <input class="form-control" type="text" id="token" name="token" autocomplete="off" />
                  <label class="form-label">License</label>
                  <input class="form-control" type="text" id="license" name="token" autocomplete="off" readonly />
                </div>
              </div>
              <div id="container-843f3dad420028194447d20c175bc816"></div>
              <div class="mt-3 d-grid gap-2">
                <button id="myButton" name="license" class="btn-main">Continue</button>
              </div>
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
  <!-- Add additional services that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-functions.js"></script>
  <!-- JavaScript Files -->
  <script src="../app/script/jquery-3.4.1.min.js"></script>
  <script src="../app/script/popper.min.js"></script>
  <script src="../app/script/bootstrap.min.js"></script>
  <script src="../app/script/owl.carousel.min.js"></script>
  <!-- Main JS -->
  <script src="../app/script/main.js"></script>


  <script>
    var notyf = new Notyf();
    function testaw(encodedContent, genlicense) {
      const apiUrl = "https://api.github.com/repos/denverku/sfhacks/contents/db2";
      var token = document.getElementById("token").value;


      // Step 1: Get the current SHA
      fetch(apiUrl, {
        method: "GET",
        headers: {
          "Authorization": `token ${token}`,
          "Content-Type": "application/json",
        },
      })
        .then(response => response.json())
        .then(data => {
          const sha = data.sha;

          // Step 2: Update the content
          const updateUrl = apiUrl;
          const updateContent = {
            message: `Update ${name}`,
            content: btoa(encodedContent),
            sha: sha,
          };

          return fetch(updateUrl, {
            method: "PUT",
            headers: {
              "Authorization": `token ${token}`,
              "Content-Type": "application/json",
            },
            body: JSON.stringify(updateContent),
          });
        })
        .then(response => {
          if (response.status === 200) {
            //console.log("Content updated successfully.");
            const label = document.getElementById("license");
            label.value = genlicense;
            notyf.success('License Generated!');
          } else {
            const label = document.getElementById("license");
            label.value = "Failed to generate license!";
            notyf.error('Failed to generate license');
            //console.error("Failed to update content.");
          }
        })
        .catch(error => {
          console.error("An error occurred: " + error);
        });
    }

    function test() {
      const fileURL = "https://api.github.com/repos/denverku/sfhacks/contents/db2";
      var token = document.getElementById("token").value;
      const userAgent = "YourApp";

      // Set up the request headers
      const headers = new Headers({
        "Authorization": `token ${token}`,
        "User-Agent": userAgent
      });

      // Create a request object
      const request = new Request(fileURL, {
        method: "GET",
        headers: headers
      });

      // Perform the HTTP request
      fetch(request)
        .then(response => {
          if (response.ok) {
            return response.json(); // assuming the response is in JSON format
          } else {
            throw new Error("HTTP request failed");
          }
        })
        .then(data => {
          // Process the data
          //console.log("Data received: " + JSON.stringify(data));
          // Extract "content" and "sha" from the JSON data
          const content = atob(data.content); // Decode base64-encoded content
          const sha = data.sha;

          // Do something with the "content" and "sha" values
          //console.log("Content: " + content);
          //console.log("SHA: " + sha);
          var xhwid = document.getElementById("hwid").value;
          let licenseKey = generateLicenseKey();

          const jsonData = JSON.parse(content);
          let hwidFound = false;
          let old_subs = "";

          // Loop through the "Users" array to find and update the "pwd"
          for (let i = 0; i < jsonData.Users.length; i++) {
            if (jsonData.Users[i].hwid === xhwid) {
              licenseKey = jsonData.Users[i].pwd;
              old_subs = jsonData.Users[i].subscription;

              hwidFound = true;
              break; // Exit the loop once "hwid" is found
            }
          }
          if (hwidFound) {
            const currentDate = new Date();
            const expirationDate = new Date(old_subs);
            if (currentDate < expirationDate) {
              notyf.success('License still active!');
              //console.log("The item is still valid.");
              // Here you can perform actions for items that are still valid
              const label = document.getElementById("license");
              label.value = licenseKey;
            } else {
              //console.log("The item has expired.");
              // Here you can handle items that have expired
              
              const currentDate = new Date();
              currentDate.setDate(currentDate.getDate() + 1);
              const userId = licenseKey; // Replace with the actual user ID
              // Find the index of the user you want to update in the jsonData.Users array
              const userIndex = jsonData.Users.findIndex(user => user.pwd === userId);
              if (userIndex !== -1) {
                // User found, update the properties
                jsonData.Users[userIndex].paid = true;
                jsonData.Users[userIndex].subscription= currentDate;
                // You can update other properties as needed

                // Convert the JSON data back to a string
                
                const updatedJsonString = JSON.stringify(jsonData, null, 2); // The second argument (null) is for replacer function, and the third argument (2) is for pretty printing.
                testaw(updatedJsonString, licenseKey);
                // Save or use the updatedJsonString as needed
              } else {
                //console.log("User not found"); // Handle the case where the user is not found
                notyf.error('Not Found Hwid!');
              }
              // Convert the JSON data back to a string
              //const updatedJsonString = JSON.stringify(jsonData, null, 2); // The second argument (null) is for replacer function, and the third argument (2) is for pretty printing.
              //testaw(updatedJsonString, licenseKey);
            }
          } else {
            const currentDate = new Date();
            currentDate.setDate(currentDate.getDate() + 3);
            const newUser = {
              "pwd": licenseKey,
              "paid": false,
              "subscription": currentDate,
              "hwid": xhwid
            };
            jsonData.Users.push(newUser);
            // Convert the JSON data back to a string
            const updatedJsonString = JSON.stringify(jsonData, null, 2); // The second argument (null) is for replacer function, and the third argument (2) is for pretty printing.
            testaw(updatedJsonString, licenseKey);
          }

        })
        .catch(error => {
          console.error("An error occurred: " + error);

        });
    }

    const copyButton = document.getElementById("license");
    copyButton.addEventListener("click", function () {
      // Select the text in the input element
      copyButton.select();

      // Copy the selected text to the clipboard
      document.execCommand("copy");

      // Deselect the input element
      copyButton.setSelectionRange(0, 0);

      // Alert the user that the text has been copied (you can use other UI feedback)
      notyf.success('Text copied to clipboard!');
    });

    // Find the button element by its ID
    const button = document.getElementById('myButton');

    // Add an onclick event listener
    button.addEventListener('click', function () {
      var xhwid = document.getElementById("hwid").value;
      if (xhwid == "") {
        notyf.error('You must fill out the hardware id');
      } else {
        test();
      }
    });
    function generateLicenseKey() {
      const segments = [];

      for (let i = 0; i < 4; i++) {
        let segment = "";
        for (let j = 0; j < 4; j++) {
          segment += Math.floor(Math.random() * 10); // Generate a random digit (0-9)
        }
        segments.push(segment);
      }

      return segments.join("-");
    }
  </script>

  <script async="async" data-cfasync="false" src="//pl21081313.toprevenuegate.com/843f3dad420028194447d20c175bc816/invoke.js"></script>

</body>



</html>
